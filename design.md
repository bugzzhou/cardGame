# 设计文档

## 框图设计



## 详细设计
### 地图 & 房间
<!-- TODO jszhou 补一个流程图 -->
分为以下流程：
- 1、随机生成地图（生成指定高度的树，剪枝算法，再按照一定比例生成指定房间类型（？，敌怪，火堆，商店，精英怪））
- 2、人 选择地图
- 3、按照 “？，敌怪，火堆，商店，精英怪” 生成指定房间的内容。（？，商店，火堆 是另外三个类别）
- 4、对于敌怪、精英怪 则需要按照指定函数，随机生成一个 <b>“敌人 & 行为”</b>（一个类）
- 5、 人 && 敌人  进行<b>战斗</b>
- 6、失败 ------ 重新开始，全部重置
- 7、成功 ------ 随机生成遗物、药水、牌

### 战斗
人 & 敌人进行交互的场景。
此处是指已经确定了人、敌人的状态时的已经开始的战斗
- 0、根据遗物产生buff、debuff 作用在己方、敌方身上（暂定，处理起来有点麻烦）。
- 1、己方回合：抽牌；打（根据打抽弃产生效果）&使用药水；结束回合
- 2、敌方回合：根据行为树随机选择一个行为，产生效果
- 3、buff、debuff减少层数

### 人 & 牌
核心部分。分为两个部分：人物属性，牌
人物属性部分，为初始生成。可以通过 牌（盛宴），药水（果汁）等进行提升，生命值降为0时，游戏结束
牌的部分，则是重中之重。 简要分为：
- 1、抽牌（从抽牌堆抽牌；从弃牌堆抽牌；从消耗的牌中抽牌）
- 2、洗牌（将弃牌堆中的牌洗入抽牌堆；所有牌全部重新进入抽牌堆（<b>重启</b>））
- 3、打牌（手牌到弃牌堆（打出触发效果），手牌到消耗的牌）
- 4、弃牌（手牌到弃牌堆（丢弃触发效果））
- 5、结束回合（结束回合，虚无效果的牌进入消耗牌堆）
四个部分。

### 敌人 & 行为
另一个核心部分。分为两个部分：敌人属性，行为
其本质上等同于“人 & 牌”章节，可以理解成是上一章节的阉割版。
（写代码很爽，所以做一点无用功）
- 敌人分为类型，名字，血量，行为（属性，出发频率）（当然也可以指定一个随机序列（图的形式，某个分支进行随机选择，并不是完全随机））
- 掉落物：一般在


### 遗物
可以理解成不是单独的模块。
从敌人身上掉落，我们捡取

### 药水
同遗物

### 事件
完全独立的模块（仅与层数相关）







## 抽排
- 判断是否够抽
- 如果够抽，抽牌堆-5，手牌+5，弃牌堆不变
- 如果不够抽，弃牌堆先洗进抽牌堆，再  抽牌堆-5，手牌+5，弃牌堆不变（0）

## 洗牌
- 弃牌堆先洗进抽牌堆

## 打牌
- 抽牌堆不变，手牌-1，弃牌堆+1


## 结束回合
- 抽牌堆不变，手牌减完，弃牌堆全加上